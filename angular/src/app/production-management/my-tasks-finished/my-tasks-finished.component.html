<div class="row clearfix" [@routerTransition]>
  <app-sub-toolbar>
    <h4>已完成的任务 <i class="fa fa-spin fa-spinner" *ngIf="isTableLoading"></i></h4>
    <div>
      <button mat-icon-button color="default">
        <mat-icon aria-label="刷新" matTooltip="刷新" (click)="refresh()">refresh</mat-icon>
      </button>
    </div>
  </app-sub-toolbar>
  <div class="table-responsive">
    <table class="table table-hover">
      <thead>
      <tr>
        <th>{{l('任务名')}}</th>
        <th>{{l('分派/转发时间')}}</th>
        <th>{{l('提交时间')}}</th>
        <th>{{l('相关构件')}}</th>
        <th></th>
      </tr>
      </thead>
      <tbody>
      <tr *ngFor="let item of taskItemAssignments | paginate: { id: 'server', itemsPerPage: pageSize, currentPage: pageNumber, totalItems: totalItems }"
          [@switchIn]>
        <td>{{item.taskItem.name}}</td>
        <td>{{item.creationTime.fromNow()}}</td>
        <td>{{item.lastModificationTime.fromNow()}}</td>
        <td>{{item.subProject?.code}}</td>
        <td>
          <button mat-icon-button matTooltip="查看构件信息" [queryParams]="{id: item.subProject ? item.subProject.id : ''}" [disabled]="!item.subProject"
                  color="default" [routerLink]="['/app/home/relational-info', {backUrl: router.url}]">
            <mat-icon>details</mat-icon>
          </button>
          <button [routerLink]="['../my-task', item.id, {readonly: 1, backUrl: router.url+';pageNumber='+pageNumber}]"
                  mat-icon-button color="primary">
            <mat-icon>chevron_right</mat-icon>
          </button>
        </td>
      </tr>
      </tbody>
    </table>
    <div class="sys-ngx-pagination" *ngIf="totalItems > pageSize">
      <pagination-controls (pageChange)="getDataPage($event)" id="server" nextLabel="下一页" previousLabel="上一页">
      </pagination-controls>
    </div>
  </div>
  <!--<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
    <div class="card main-content" [@switchIn] *ngIf="moreTaskItemAssignments && moreTaskItemAssignments.length > 0">
      <div class="header">
        <h2>{{l('任务详细情况')}}</h2>
      </div>
      <div class="body table-responsive">
        <table class="table table-hover clear-margin">
          <thead>
          <tr>
            <th>{{l('分派/转发时间')}}</th>
            <th>{{l('任务类型')}}</th>
            <th>{{l('提交时间')}}</th>
            <th></th>
          </tr>
          </thead>
          <tbody>
          <tr *ngFor="let moreTaskItemAssignment of moreTaskItemAssignments">
            <td>{{moreTaskItemAssignment.creationTime | date: 'yyyy-MM-dd HH:mm:ss'}}</td>
            <td>
              <ng-container *ngIf="moreTaskItemAssignment.isForwarded">转发</ng-container>
              <ng-container *ngIf="!moreTaskItemAssignment.isForwarded">普通</ng-container>
            </td>
            <td>{{moreTaskItemAssignment.lastModificationTime | date: 'yyyy-MM-dd HH:mm:ss'}}</td>
            <td>
              <button mat-button color="primary"
              >
                详情
              </button>
            </td>
          </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>-->
</div>
